SELECT *
FROM (
    SELECT
        cf.patient_id,
        cf.patient_name,
        cf.facility_id,
        rf.sub_category,
        rf.display_value
    FROM case_fact cf
    JOIN report_fact rf
      ON cf.calculation_id = rf.calculation_id
) 
PIVOT (
    MAX(display_value)
    FOR sub_category IN (
        'Age'    AS age,
        'Gender' AS gender,
        'Race'   AS race
    )
)
ORDER BY patient_id;