import csv

with open("subcats.csv") as f:
    reader = csv.reader(f)
    subcats = [row[0].strip() for row in reader]

for sub in subcats:
    alias = sub.lower().replace(" ", "_")  # simple aliasing
    print(f"    LISTAGG(CASE WHEN UPPER(TRIM(rf.sub_category)) = '{sub.upper()}' "
          f"THEN rf.display_value END, ', ') "
          f"WITHIN GROUP (ORDER BY rf.display_value) AS {alias},")