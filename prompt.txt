SELECT c.patient_id,
       c.facility_id,
       c.form_record_id,
       '{' ||
       LISTAGG(
         '"' || r.sub_category || '":"' || r.display_value || '"',
         ','
       ) WITHIN GROUP (ORDER BY r.sub_category)
       || '}' AS subcategory_json
FROM rpt_case_fact c
JOIN rpt_report_fact r
  ON c.calculation_id = r.calculation_id
WHERE r.sub_category IN (
  SELECT column_value
  FROM CSV_TABLE -- load your subcat.csv into a staging table or external table
)
GROUP BY c.patient_id, c.facility_id, c.form_record_id;